Arabian Journal for Science and Engineering

1

0.8

0.6

0.4

0.2

0

0

VL

L

M

H

VH

500

1000 1500 2000 2500 3000 3500

Number of vehivles

1

0.8

0.6

0.4

0.2

0

0

VS

S

M

H

VH

10

20

30
Delay

40

50

60

Fig. 2 Membership function of number of vehicles enter the street for
reward FIS

Fig. 3 Membership function of average delay for reward FIS

which is given by the American Highway Capacity Manual
(HCM) [4, Eq.20]:

d = 0.38

C(1 − λ)2
1 − x
(cid:9)

+ 173x 2

(x − 1) +

(cid:11)

(cid:10)
(x − 1)2 + 16x
C

(5)

where d, C, λ, and x are average delay (s), cycle time (s),
green ratio, and degree of saturation, respectively. λ = g
c
and x = v
c , where c, g, and v are capacity (vehicle per hour),
green time (sec), and input volume, respectively. We use this
model to calculate average delay based on the green phase
duration and number of vehicles. For more details of this
equation, we refer to [4].

Assume that C = T = 100 s and c = 3500 veh/h. v is
volume of vehicles entering each street which varies between
0 to 3500 veh/h. g is duration of the green phase which each
agent selects considering fuzzy Q-learning and interaction
with adjacent agents. The trafﬁc network simulation algo-
rithm is as follow:

1. The volume of vehicles entering each intersection (v) are
randomly generated by a discrete uniform distribution on
the interval [0, 3500].

2. Average delay is calculated by Eq. 5.
3. Each agent decides on the time of green phase g.
4. Go to step 1 until end of simulation time.

Assume structure of the agents as in Fig. 1 with the Mam-
dani FIS with input membership function as in Fig. 2 for
number of input vehicles and Fig. 3 for average delay to
calculate the reward functions r j (si , ai ). Centroid defuzzi-
ﬁcation by the output membership function as in Fig. 4 is
considered to estimate a reward value in interval [− 3, 3].
The weighting function FIS has number of vehicles, its own
green phase duration and the neighbor agents’ green phase
duration as inputs. Figure 2 shows the membership function
for number of vehicles, and Fig. 5 depicts the membership

VS

1

0.8

0.6

0.4

0.2

0

-3

S

M

H

VH

-2

-1

0
Reward

1

2

3

Fig. 4 Membership function of output for reward FIS

1

0.8

0.6

0.4

0.2

0

0

L

M

H

20

40

60

80

100

Green phase duration

Fig. 5 Membership function of green phase duration for weighting
function FIS

function for its own and neighbor green phase duration. Cen-
troid defuzziﬁcation is applied to calculate weights on output
membership function as in Fig. 6 which should be a value
between 0 and 1.
Finally, the agent uses fuzzy Q-learning (Eq. 2) with Q-value
update rule (Eq. 4) where learning and discount factor are
selected to be 0.5 and 0.7, respectively. The membership
function for each measured number of vehicles is shown in
Fig. 7. The output estimates green phase duration with mem-
bership functions as in Fig. 8.
The proposed method is compared with Fuzzy Q-learning
(using Eq. 2 where q[i, j] is the Q-value which updates
with Eq. 1), Q-learning (using Q-learning method with Q-
value which updates with Eq. 1), fuzzy(using traditional
fuzzy inference method) and ﬁxed time (tg = 60 s) in
the sense of total average delay. Average delay in each

123

