th agent. f (i, j) ∈ [0, 1] is a weighted function which shows
the effect of r j (si , ai ) on i-th agent. Mathematical functions
are suggested in [33] for r (s, a) and f (i, j). Assumption of
discrete action-state space and determination of reward and
weighting functions are drawbacks of that work.

4 Problem Statements

Consider a trafﬁc network in which the lights of each inter-
section is controlled by an autonomous agents without any
centralized management. Some sensors which are installed
below the surface of surrounding streets or trafﬁc cameras
of each intersection provide information about trafﬁc situa-
tion for the corresponding agent. An agent has to decide on
duration of green light at north–south (NS) and west–east
(WE) paths. Also, any agent interacts with neighbor agents.
Anyway, the agent is expected to schedule trafﬁc lights opti-
mally, in the sense of average delay, based on the received
information from its sensors and received information from
neighbor agents.

The agents may have little knowledge about others’ deci-
sion due to distribution of information. Even if an agent has
previous known information about others’ decision, it is not
valid as other agents are also learning. Thus, the environ-
ment is dynamic and the behavior of other agents may change
during time. Lack of prediction of other agents causes uncer-
tainty in problem solving procedure. This paper looks for a
decision-making algorithm for lights control agents which
considers neighbor agents information in addition to its own
information.

5 Proposed Algorithm

We consider a constant duration T for green plus red phases.
So, if the agent determines the green phase duration tg, then
the red phase duration is tr = T − tg. Any typical agent i
receives number of vehicles on the NS and WE streets from
its own sensors and the green phase duration of neighbor
agent j in order to schedule its own green phase duration.
This paper proposes an autonomous agent with structure in
Fig. 1 to control each intersection.
The number of vehicles in WE and NS streets which are mea-
sured by sensors are fuzziﬁed. Then, a fuzzy inference engine
with rules as Eq. 2 are employed to ﬁre the corresponding
output membership functions. Finally, defuzziﬁcation results
to duration of green phase in NS path (t N S
). Thus, the dura-
= T −t N S
tion of green phase in other path, WE, is t W E
. We
propose that, Q-value function which is updated by Eq. 4 be
the value of each action in Eq. 2 which is denoted by q[i, j].
This update equation takes the neighbor agents’ decision into
account.

g

g

g

123

Arabian Journal for Science and Engineering

Fig. 1 The proposed structure for a typical agent

The i-th agent takes decision of neighbor agent

j into
account by reward r j (si , ai ) and a weighting function
f (i, j). The reward is calculated based on average delay
obtained from the decision made by the agent and current
trafﬁc situation in a fuzzy manner. A fuzzy inference engine
obtains these two inputs after fuzziﬁcation and gives the
reward after defuzziﬁcation; see Fig. 1. weighting function
f (i, j) ∈ [0, 1] shows the effect of r j (si , ai ) on the deci-
sion of i-th agent. This weight is also calculated by a fuzzy
inference engine. This engine takes its own tg, the neighbor
agents’ tg, and number of waited vehicles and gives f (i, j).
Suitable choice for reward and weighting function plays a
signiﬁcant role in agent learning. The agent with structure in
Fig. 1 runs the following algorithm:

1. Initial value of Qi -value for i-th trafﬁc signal control

agent is in the form of ∀(si , ai ) : Qi (si , ai ) = 0.

2. Observing si by WE and NS sensors which is the current

state of i-th intersection.

3. Selecting a proper estimation for desired state by fuzzy

inference system.

4. Calculating the reward related to i-th and j-th trafﬁc
signal control agent and the weighting function for neigh-
boring agents separately.
5. Observing new state s(cid:2)
i .
6. Updating Qi -value according to Eq. 4.
7. Returning to step 2 till the variation of Q-value becomes

less than (cid:4).

6 Simulation Results

Consider a trafﬁc network with a center and four neighbor
intersection. The delay in each intersection depends on phys-
ical characteristics of the intersection, trafﬁc light scheduling
and number of cars in input streets. We utilized trafﬁc model

